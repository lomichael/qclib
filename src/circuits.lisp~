(defstruct quantum-circuit
  (gates :type list))

(defun add-gate (circuit gate)
  (push gate (quantum-circuit-gates circuit)))

(defun execute-circuit (circuit initial-state)
  (let ((state initial-state))
    (dolist (gate (reverse (quantum-circuit-gates circuit)))
      (setf state (funcall (gate-operation gate) state)))
    state))
